---
title: Customize Flow Stages
slug: guides/customize-flow-stages
---

Hook into lifecycle stages to enforce policy, add telemetry, or transform IO.

Concepts

- Flows are named pipelines with stages; hook helpers expose typed `Will`, `Stage`, `Did`, and `Around` variants.
- Use `FlowHooksOf('flow:name')` to target a specific flow like `tools:call-tool`, `tools:list-tools`, or `http:request`.
- Priority orders execution; higher runs earlier for Will/Stage, Did runs in reverse.

Example

```ts
import { FlowCtxOf, FlowHooksOf } from '@frontmcp/sdk';

const ToolHook = FlowHooksOf('tools:call-tool');

class MyHooks {
  @ToolHook.Will('validateInput', { priority: 100 })
  requireFields(ctx: FlowCtxOf<'tools:call-tool'>) {
    // if (!ctx.state.required.toolContext?.input.amount) throw new Error('amount required');
  }

  @ToolHook.Did('execute')
  redact(ctx: FlowCtxOf<'tools:call-tool'>) {
    // ctx.state.required.toolContext.output = redact(ctx.state.required.toolContext.output);
  }

  @ToolHook.Around('execute')
  async trace(ctx: FlowCtxOf<'tools:call-tool'>, next: () => Promise<void>) {
    const start = Date.now();
    await next();
    ctx.logger.info({ latency: Date.now() - start }, 'tool executed');
  }
}
```

Tips

- Contribute hooks from a Plugin to reuse across apps.
- Use the provided context to share data between stages in the same flow.
- `FlowHooksOf` works for any registered flow; create your own via `FlowHooksOf('http:request')` or custom names.
