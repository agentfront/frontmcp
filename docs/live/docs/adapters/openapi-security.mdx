---
title: OpenAPI Adapter Security & Generator Options
slug: adapters/openapi-security
description: Keep generated tools safe and tuned with auth mapping, risk scoring, and generator flags.
icon: shield-check
---

The OpenAPI Adapter rides on [`mcp-from-openapi`](https://www.npmjs.com/package/mcp-from-openapi). That generator now emits per-operation metadata, automatic request mappers, and a security analysis. Use this page whenever you need to reason about authentication, risk levels, or the knobs exposed by `generateOptions`.

## Security scoring in the adapter

Every adapter instance runs a quick audit when it boots. It inspects your configuration (`authProviderMapper`, `securityResolver`, `staticAuth`, `generateOptions.includeSecurityInInput`) and tags the adapter with a risk level. The score determines which warnings are logged and which callouts land in your terminal.

| Risk          | Triggered when                                                                                                | What to do                                                                                                      |
| ------------- | ------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| **LOW** ‚úÖ    | You provide `authProviderMapper` and/or `securityResolver` so tokens come from the authenticated user context | This is the recommended path for multi-provider APIs. Rotate secrets in the IdP, not in your MCP clients.       |
| **MEDIUM** ‚ö†Ô∏è | You rely on `staticAuth`, `additionalHeaders`, or the default behavior without mapping specific schemes       | Only use for trusted server-to-server calls. Store secrets in env vars and lock down the app to approved users. |
| **HIGH** üö®   | `generateOptions.includeSecurityInInput` is `true`, exposing auth fields to the MCP client                    | Avoid this in production. The flag exists for quick prototyping and Inspector testing only.                     |

<Tip>
  Watch the adapter logs on boot. A ‚ö†Ô∏è warning about ‚ÄúSecurity configuration: MEDIUM risk‚Äù means you should revisit the
  sections below before shipping to production.
</Tip>

## Recommended auth wiring

### Map OpenAPI schemes to providers (preferred)

```ts
import { App } from '@frontmcp/sdk';
import { OpenapiAdapter } from '@frontmcp/adapters';

@App({
  id: 'crm',
  name: 'CRM API',
  adapters: [
    OpenapiAdapter.init({
      name: 'backend:crm',
      url: process.env.CRM_SPEC_URL!,
      baseUrl: process.env.CRM_BASE_URL!,
      authProviderMapper: {
        OAuthGithub: (authInfo) => authInfo.user?.githubToken,
        ApiKeyAuth: (authInfo) => authInfo.user?.apiKey,
        ServiceAccount: (authInfo) => authInfo.user?.serviceTokens?.crm,
      },
    }),
  ],
})
export default class CrmApp {}
```

- Each security scheme in your spec maps to a function that extracts the right credential from `authInfo`.
- Credentials never appear in tool schemas, logs, or MCP payloads.
- Mixed providers (GitHub + Slack + API keys) all work inside a single adapter.

### Use a custom `securityResolver` when schemes depend on context

If the scheme-to-provider mapping needs logic (per tool, per path, per user), implement a resolver:

```ts
OpenapiAdapter.init({
  name: 'backend:ops',
  url: process.env.OPS_SPEC_URL!,
  baseUrl: process.env.OPS_BASE_URL!,
  securityResolver: (tool, authInfo) => {
    if (tool.metadata.tags?.includes('slack')) {
      return { jwt: authInfo.user?.slackToken };
    }
    if (tool.metadata.tags?.includes('internal')) {
      return { apiKey: process.env.INTERNAL_API_KEY! };
    }
    return { jwt: authInfo.token };
  },
});
```

Resolvers still score as **LOW** risk because credentials stay server-side. They are perfect for tenant-aware routing, or when you need to blend user tokens with privileged service accounts.

### Static headers and input security (last resort)

`staticAuth`, `additionalHeaders`, or `generateOptions.includeSecurityInInput` are intentionally scored higher:

- Static secrets live in env vars. Rotate them the same way you rotate any other infrastructure secret.
- `includeSecurityInInput: true` makes auth fields part of the tool input schema so clients must supply them. That leaks secrets to every MCP consumer and to any logging middleware they run. Use it only when you are debugging an API that has no auth requirements yet.

<Warning>
  Never enable `includeSecurityInInput` on a production server. The adapter flags the configuration as **HIGH risk** and prints a warning, but it cannot stop you from leaking tokens.
</Warning>

## Generator options cheat sheet

`generateOptions` flows directly into `mcp-from-openapi`. Use it to trim the toolset, expose deprecated routes during migrations, or enrich schemas with examples.

| Option                   | Type / Default                            | Use it to                                                           |
| ------------------------ | ----------------------------------------- | ------------------------------------------------------------------- |
| `includeOperations`      | `string[]`                                | Generate a allowlist of operationIds only.                          |
| `excludeOperations`      | `string[]`                                | Drop noisy operations from large specs.                             |
| `filterFn`               | `(operation) => boolean`                  | Apply arbitrary logic (tags, verbs, paths).                         |
| `namingStrategy`         | `{ conflictResolver, toolNameGenerator }` | Override how conflicting params or tool names are generated.        |
| `preferredStatusCodes`   | `number[]` (default `[200,201,202,204]`)  | Choose which responses become the primary output schema.            |
| `includeDeprecated`      | `boolean` (default `false`)               | Surface deprecated endpoints when you need to support migrations.   |
| `includeAllResponses`    | `boolean` (default `true`)                | Collapse to a single preferred response by setting this to `false`. |
| `maxSchemaDepth`         | `number` (default `10`)                   | Guard against runaway `$ref` chains in huge specs.                  |
| `includeExamples`        | `boolean` (default `false`)               | Copy OpenAPI examples into the generated schemas.                   |
| `includeSecurityInInput` | `boolean` (default `false`)               | Force security schemes into the input schema. **Avoid in prod.**    |

<Info>
  `loadOptions` (headers, fetch timeout, file loaders) still come from `mcp-from-openapi`. Set them when your spec
  lives behind auth or you need to tweak retry behavior.
</Info>

## Example configuration

```ts
OpenapiAdapter.init({
  name: 'backend:billing',
  url: 'https://api.example.com/openapi.json',
  baseUrl: 'https://api.example.com',
  authProviderMapper: {
    BillingOAuth: (authInfo) => authInfo.user?.billingToken,
  },
  generateOptions: {
    includeOperations: ['listInvoices', 'createInvoice'],
    excludeOperations: ['deleteInvoice'],
    preferredStatusCodes: [200, 201],
    includeExamples: true,
    includeDeprecated: false,
    includeSecurityInInput: false,
  },
  loadOptions: {
    headers: { 'x-spec-version': '2025-11' },
    timeoutMs: 15000,
  },
});
```

This setup:

- Loads the spec with a custom header, so you can pin versions on the server.
- Limits tool generation to two stable operations.
- Keeps auth hidden from clients while still providing examples for the Inspector.

## Troubleshooting signals

- **‚ÄúMissing auth provider mappings‚Äù** ‚Üí a scheme defined in the OpenAPI document has no `authProviderMapper` entry. Add one or fall back to `securityResolver`.
- **‚ÄúSecurity configuration: HIGH risk‚Äù** ‚Üí `includeSecurityInInput` slipped into your config. Remove it or gate it behind an environment flag.
- **‚ÄúNo preferred status code found‚Äù** ‚Üí adjust `preferredStatusCodes` or set `includeAllResponses: true` so the generator can fall back to the first available response.
- **‚ÄúFilter removed all operations‚Äù** ‚Üí relax `includeOperations`/`excludeOperations` or the custom `filterFn`.

Use this page together with the main [OpenAPI Adapter](/docs/adapters/openapi-adapter) reference: that page covers end-to-end setup, while this one dives into the knobs you reach for during hardening.
