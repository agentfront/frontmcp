---
title: CodeCall CRM Demo
slug: guides/codecall-crm-demo
icon: users-round
description: Explore the multi-tool CRM sample that showcases the CodeCall plugin in action.
---

The FrontMCP monorepo ships a full CRM reference app at `apps/demo/src/apps/crm`. It demonstrates how to group many CRUD tools behind the CodeCall plugin, feed them with an in-memory data store, and expose them through a single CodeCall entry point.

<Info>
Source: `apps/demo/src/apps/crm`. The `apps/demo/src/apps/crm/data/store.ts` module seeds sample users and activities so the tools return realistic data without additional services.
</Info>

## Architecture overview

- **CodeCall plugin** – `CodeCallPlugin.init({ topK: 10 })` runs in `codecall_only` mode so models discover tools via search rather than the global tool list.
- **Eight dedicated tools** – Separate tool classes handle user CRUD plus activity logging and stats.
- **Typed data store** – `CrmStore` exposes `users` and `activities` helpers for list, get, mutate, and aggregate operations.
- **Zod validation** – Every tool validates inputs (email, enums, limits) before touching the store and returns structured responses.

## App and plugin wiring

```ts
import { App } from '@frontmcp/sdk';
import { CodeCallPlugin } from '@frontmcp/plugins';
import UsersListTool from './tools/users-list.tool';
import UsersGetTool from './tools/users-get.tool';
import UsersCreateTool from './tools/users-create.tool';
import UsersUpdateTool from './tools/users-update.tool';
import UsersDeleteTool from './tools/users-delete.tool';
import ActivitiesListTool from './tools/activities-list.tool';
import ActivitiesLogTool from './tools/activities-log.tool';
import ActivitiesStatsTool from './tools/activities-stats.tool';

@App({
  id: 'crm',
  name: 'CRM Demo with CodeCall',
  description: 'A demo CRM application showcasing CodeCall plugin for AgentScript-based tool orchestration',
  plugins: [
    CodeCallPlugin.init({
      topK: 10, // return up to 10 relevant tools per search request
    }),
  ],
  tools: [
    UsersListTool,
    UsersGetTool,
    UsersCreateTool,
    UsersUpdateTool,
    UsersDeleteTool,
    ActivitiesListTool,
    ActivitiesLogTool,
    ActivitiesStatsTool,
  ],
})
export default class CrmMcpApp {}
```

## Tool catalog

| Tool               | Category   | What it does                                                   |
| ------------------ | ---------- | -------------------------------------------------------------- |
| `users:list`       | Users      | Filter users by status or role with pagination-friendly limits |
| `users:get`        | Users      | Fetch a profile by ID or email                                 |
| `users:create`     | Users      | Create a new user with default role/status enforcement         |
| `users:update`     | Users      | Patch name, role, status, or last login                        |
| `users:delete`     | Users      | Remove a user after verifying they exist                       |
| `activities:list`  | Activities | Return recent activities with optional user/type filters       |
| `activities:log`   | Activities | Append an activity and update `lastLoginAt` on login events    |
| `activities:stats` | Activities | Summarize total activity counts grouped by type                |

Each tool extends `ToolContext`, so the CodeCall plan receives consistent logging, auth info, and error handling.

## CrmStore helpers

The in-memory store keeps sample data and exposes ergonomic helpers. Tools resolve it directly instead of re-implementing storage logic.

```ts
import { CrmStore } from '../data/store';

// Create a new pending user
const user = CrmStore.users.create({
  email: 'sasha@example.com',
  name: 'Sasha Rivera',
  role: 'user',
  status: 'pending',
});

// Promote and timestamp existing users
CrmStore.users.update(user.id, { status: 'active', role: 'admin' });

// Show activity stats for dashboards
const stats = CrmStore.activities.getStats(user.id);
```

Because everything is in memory, the demo stays deterministic and easy to reset between sessions.

## Log activities through CodeCall

The `activities:log` tool validates the user before writing an entry and automatically updates `lastLoginAt` for login events—perfect for showcasing multi-step plans.

```ts
@Tool({
  name: 'activities:log',
  description: 'Log a new activity for a user in the CRM.',
  inputSchema: {
    userId: z.string(),
    type: z.enum(['login', 'logout', 'page_view', 'action', 'error']),
    description: z.string(),
    metadata: z.record(z.unknown()).optional(),
  },
})
export default class ActivitiesLogTool extends ToolContext {
  async execute(input: { userId: string; type: Activity['type']; description: string; metadata?: Record<string, unknown> }) {
    const user = CrmStore.users.get(input.userId);
    if (!user) {
      throw new Error(`User ${input.userId} not found`);
    }

    const activity = CrmStore.activities.create({
      userId: input.userId,
      type: input.type,
      description: input.description,
      metadata: input.metadata,
    });

    if (input.type === 'login') {
      CrmStore.users.update(input.userId, { lastLoginAt: activity.timestamp });
    }

    return { activity, success: true };
  }
}
```

## Run it locally

<Steps>
  <Step stepNumber={1} title="Install workspace dependencies">
    ```bash
    pnpm install
    ```
  </Step>
  <Step stepNumber={2} title="Start the demo server">
    ```bash
    pnpm nx serve demo
    ```
    The dev server prints the HTTP URL (for example `http://localhost:5173`). Keep this terminal open.
  </Step>
  <Step stepNumber={3} title="Open the MCP Inspector">
    Run `npx @modelcontextprotocol/inspector`, paste the server URL from the previous step, and click **Connect**.
  </Step>
  <Step stepNumber={4} title="Exercise CodeCall">
    Call `codecall.search`, `codecall.describe`, and `codecall.execute` from the Inspector to watch the CRM tools run inside the sandbox.
  </Step>
</Steps>

<Tip>
Pair this demo with the [platform-aware UI guide](/docs/guides/ui-library) to style consent and troubleshooting screens for your own CodeCall deployments.
</Tip>
