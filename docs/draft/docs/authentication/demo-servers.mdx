---
title: Authentication Demo Servers
slug: authentication/demo-servers
icon: terminal
description: Run the Nx sample servers that showcase public, transparent, and orchestrated authentication modes.
---

FrontMCP bundles three ready-to-serve authentication demos under `apps/e2e/**`. Each project runs the same Notes + Tasks apps but wires a different auth mode, transport policy, and consent experience so you can validate clients before touching your own code.

## Projects at a glance

| Project                         | Mode                     | Default port | Highlights                                                                                                                        | Serve command                                             |
| ------------------------------- | ------------------------ | ------------ | --------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------- |
| `demo-e2e-public`               | `public`                 | `3003`       | Anonymous sessions with scoped tools, Streamable HTTP + JSON fallback                                                             | `pnpm nx serve demo-e2e-public --port 3003`               |
| `demo-e2e-orchestrated`         | `orchestrated` (local)   | `3005`       | Stateful sessions, consent UI, incremental auth controls                                                                          | `pnpm nx serve demo-e2e-orchestrated --port 3005`         |
| `demo-e2e-transparent`          | `transparent`            | `3004`       | Proxies tokens to a remote IdP while keeping local consent + transport policies                                                   | `pnpm nx serve demo-e2e-transparent --port 3004`          |
| `demo-e2e-transport-recreation` | `public (transport lab)` | `3020`       | Tools that surface session IDs, request counters, and recreateable Streamable HTTP handshakes so you can audit session continuity | `pnpm nx serve demo-e2e-transport-recreation --port 3020` |

<Note>
All commands assume `pnpm install` has already been run at the repo root. Replace the port if it conflicts with another service.
</Note>

## Run a demo locally

<Steps>
<Step title="Pick a project">
Decide which auth mode to explore (`demo-e2e-public`, `demo-e2e-transparent`, or `demo-e2e-orchestrated`).
</Step>
<Step title="Configure environment">
Transparent mode needs an upstream IdP. Export `IDP_PROVIDER_URL` and `IDP_EXPECTED_AUDIENCE` before serving:

```bash
export IDP_PROVIDER_URL="https://auth.example.com"
export IDP_EXPECTED_AUDIENCE="https://api.example.com"
```

</Step>
<Step title="Serve the project">
Run `pnpm nx serve <project> --port <port>` and wait for the `Listening on` log. Requests are available at `http://localhost:<port>`.

<Check>
`curl http://localhost:<port>/health` returns `ok` when the server is ready.
</Check>
</Step>
</Steps>

---

## demo-e2e-public: instant anonymous access

```ts title="apps/e2e/demo-e2e-public/src/main.ts"
@FrontMcp({
  auth: {
    mode: 'public',
    sessionTtl: 3600,
    anonymousScopes: ['anonymous'],
  },
  transport: {
    enableStatefulHttp: true,
    enableStreamableHttp: true,
    enableStatelessHttp: false,
    requireSessionForStreamable: false,
  },
});
```

- Exercises the `auth.publicAccess` path without any login UI.
- Turns on stateful HTTP so you can hit tools and resources via plain JSON for smoke tests.
- Leaves Streamable HTTP enabled for real MCP clients while skipping the `initialize` handshake.

<Tip>
Use this project with `@frontmcp/testing` when you want fast, anonymous fixtures that still cover transport-level behavior.
</Tip>

---

## demo-e2e-orchestrated: built-in OAuth server

```ts title="apps/e2e/demo-e2e-orchestrated/src/main.ts"
@FrontMcp({
  auth: {
    mode: 'orchestrated',
    type: 'local',
    consent: {
      enabled: true,
      groupByApp: true,
      showDescriptions: true,
      requireSelection: true,
    },
    allowDefaultPublic: false,
  },
  transport: {
    sessionMode: 'stateful',
    enableStatefulHttp: true,
    enableStreamableHttp: true,
    enableStatelessHttp: false,
    requireSessionForStreamable: false,
  },
});
```

- Spins up the full OAuth 2.1 stack (authorization code + PKCE) entirely inside FrontMCP.
- Shows the consent UI grouping tools by app, plus incremental auth defaults.
- Uses the same transport defaults documented in [Transport controls](/docs/servers/server#transport) so you can compare behavior with production builds.

<Warning>
The demo login accepts any email address. Replace it with a real IdP before exposing the flow to users.
</Warning>

---

## demo-e2e-transparent: pass-through tokens

```ts title="apps/e2e/demo-e2e-transparent/src/main.ts"
@FrontMcp({
  auth: {
    mode: 'transparent',
    remote: {
      provider: process.env.IDP_PROVIDER_URL!,
      dcrEnabled: false,
    },
    expectedAudience: process.env.IDP_EXPECTED_AUDIENCE!,
    requiredScopes: [],
    allowAnonymous: false,
  },
  transport: {
    enableStatefulHttp: true,
    enableStreamableHttp: true,
    enableStatelessHttp: false,
    requireSessionForStreamable: false,
  },
});
```

- Validates upstream JWTs while reusing the same consent UI and transport toggles.
- Demonstrates how to forward-declare an IdP without shipping secretsâ€”set `IDP_PROVIDER_URL`/`IDP_EXPECTED_AUDIENCE` per environment.
- Keeps anonymous access off so every tool call requires a verified token.

<Note>
If your IdP exposes a JWKS file, frontload the URL in `remote.jwksUri` to skip metadata discovery during tests.
</Note>

---

## demo-e2e-transport-recreation: session recreation lab

```ts title="apps/e2e/demo-e2e-transport-recreation/src/main.ts"
import { FrontMcp, LogLevel } from '@frontmcp/sdk';
import { TransportTestApp } from './apps/transport-test';

const portEnv = process.env['PORT'] ?? '3020';
const port = parseInt(portEnv, 10);
if (isNaN(port) || port < 1 || port > 65535) {
  throw new Error(`Invalid PORT environment variable: "${portEnv}". Must be a number between 1 and 65535.`);
}

@FrontMcp({
  info: { name: 'Demo E2E Transport Recreation', version: '0.1.0' },
  apps: [TransportTestApp],
  logging: { level: LogLevel.VERBOSE },
  http: { port },
  auth: {
    mode: 'public',
    sessionTtl: 3600,
    anonymousScopes: ['anonymous'],
    transport: {
      enableStatefulHttp: true,
      enableStreamableHttp: true,
      enableStatelessHttp: false,
      requireSessionForStreamable: false,
      enableLegacySSE: true,
      enableSseListener: true,
    },
  },
})
export default class Server {}
```

- The `TransportTestApp` registers the `get-session-info` and `increment-counter` tools so you can inspect every session ID and track a session-scoped counter through repeated requests.
- Stateful HTTP, streamable HTTP, and SSE listeners stay on to replay initialization state while the recreateable transport reconnects a client.
- `LogLevel.VERBOSE` plus the recreateable transport warnings reveal pending initialization state, pending SDK internals, and the first `handleRequest` after a cold start.

<Note>
  Start the lab with `pnpm nx serve demo-e2e-transport-recreation --port 3020` so you can point `@frontmcp/testing` or the Inspector at a consistent port.
</Note>

<Tip>
  Call `get-session-info` and `increment-counter` before and after restarting the server to prove the same session ID carries the counter value even when the transport is recreated.
</Tip>

---

## Test with @frontmcp/testing

You can point the Jest fixtures at any demo by spinning it up through the built-in `TestServer` helper:

```ts title="demo-public.e2e.ts"
import { test, expect, TestServer } from '@frontmcp/testing';

let serverProcess;

test.beforeAll(async () => {
  serverProcess = await TestServer.startNx('demo-e2e-public', { port: 4001 });
});

test.afterAll(async () => {
  await serverProcess?.stop();
});

test.use({
  server: serverProcess?.info.baseUrl ?? 'http://localhost:4001',
  transport: 'streamable-http',
});

test('lists demo tools', async ({ mcp }) => {
  const tools = await mcp.tools.list();
  expect(tools).toContainTool('create-note');
});
```

Pair this with the [Transport controls reference](/docs/servers/server#transport) to mirror the exact transports your production server exposes.

---

## What to read next

<CardGroup cols={2}>
  <Card title="Authentication Modes" icon="layer-group" href="/docs/authentication/modes">
    Understand when to reach for public, transparent, or orchestrated auth.
  </Card>
  <Card title="Transport controls" icon="server" href="/docs/servers/server#transport-controls">
    Dive deeper into Streamable, stateful, and stateless HTTP settings.
  </Card>
</CardGroup>
